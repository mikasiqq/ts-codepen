{"ast":null,"code":"import * as esbuild from \"esbuild-wasm\";\nimport { unpkgPathPlugin } from \"./plugins/UnpkgPathPlugin\";\nimport { fetchPlugin } from \"./plugins/FetchPlugin\";\nlet service;\nconst bundle = async rawCode => {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: \"https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm\"\n    });\n  }\n  try {\n    const result = await service.build({\n      entryPoints: [\"index.js\"],\n      bundle: true,\n      write: false,\n      plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\n      define: {\n        \"process.env.NODE_ENV\": '\"production\"',\n        global: \"window\"\n      }\n    });\n    return {\n      code: result.outputFiles[0].text,\n      error: \"\"\n    };\n  } catch (err) {\n    if (err instanceof Error) return {\n      code: \"\",\n      error: err.message\n    };else {\n      throw err;\n    }\n  }\n};\nexport default bundle;","map":{"version":3,"names":["esbuild","unpkgPathPlugin","fetchPlugin","service","bundle","rawCode","startService","worker","wasmURL","result","build","entryPoints","write","plugins","define","global","code","outputFiles","text","error","err","Error","message"],"sources":["/Users/gleb/Desktop/study/react/ts-codepen/src/bundler/index.ts"],"sourcesContent":["import * as esbuild from \"esbuild-wasm\";\nimport { unpkgPathPlugin } from \"./plugins/UnpkgPathPlugin\";\nimport { fetchPlugin } from \"./plugins/FetchPlugin\";\n\nlet service: esbuild.Service;\nconst bundle = async (rawCode: string) => {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: \"https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm\",\n    });\n  }\n  try {\n    const result = await service.build({\n      entryPoints: [\"index.js\"],\n      bundle: true,\n      write: false,\n      plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\n      define: {\n        \"process.env.NODE_ENV\": '\"production\"',\n        global: \"window\",\n      },\n    });\n\n    return {\n      code: result.outputFiles[0].text,\n      error: \"\",\n    };\n  } catch (err) {\n    if (err instanceof Error)\n      return {\n        code: \"\",\n        error: err.message,\n      };\n    else {\n      throw err;\n    }\n  }\n};\n\nexport default bundle;\n"],"mappings":"AAAA,OAAO,KAAKA,OAAO,MAAM,cAAc;AACvC,SAASC,eAAe,QAAQ,2BAA2B;AAC3D,SAASC,WAAW,QAAQ,uBAAuB;AAEnD,IAAIC,OAAwB;AAC5B,MAAMC,MAAM,GAAG,MAAOC,OAAe,IAAK;EACxC,IAAI,CAACF,OAAO,EAAE;IACZA,OAAO,GAAG,MAAMH,OAAO,CAACM,YAAY,CAAC;MACnCC,MAAM,EAAE,IAAI;MACZC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;EACA,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMN,OAAO,CAACO,KAAK,CAAC;MACjCC,WAAW,EAAE,CAAC,UAAU,CAAC;MACzBP,MAAM,EAAE,IAAI;MACZQ,KAAK,EAAE,KAAK;MACZC,OAAO,EAAE,CAACZ,eAAe,EAAE,EAAEC,WAAW,CAACG,OAAO,CAAC,CAAC;MAClDS,MAAM,EAAE;QACN,sBAAsB,EAAE,cAAc;QACtCC,MAAM,EAAE;MACV;IACF,CAAC,CAAC;IAEF,OAAO;MACLC,IAAI,EAAEP,MAAM,CAACQ,WAAW,CAAC,CAAC,CAAC,CAACC,IAAI;MAChCC,KAAK,EAAE;IACT,CAAC;EACH,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZ,IAAIA,GAAG,YAAYC,KAAK,EACtB,OAAO;MACLL,IAAI,EAAE,EAAE;MACRG,KAAK,EAAEC,GAAG,CAACE;IACb,CAAC,CAAC,KACC;MACH,MAAMF,GAAG;IACX;EACF;AACF,CAAC;AAED,eAAehB,MAAM"},"metadata":{},"sourceType":"module"}