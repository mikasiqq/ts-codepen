{"ast":null,"code":"import\"./CodeEditor.css\";import\"./SyntaxHighlighting.css\";import MonacoEditor from\"@monaco-editor/react\";import{useRef}from\"react\";import prettier from\"prettier\";import parser from\"prettier/parser-babel\";import codeShift from\"jscodeshift\";import Highlighter from\"monaco-jsx-highlighter\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CodeEditor=function CodeEditor(_ref){var onChange=_ref.onChange,initialValue=_ref.initialValue;var editorRef=useRef();var onEditorDidMount=function onEditorDidMount(getValue,monacoEditor){var _monacoEditor$getMode;editorRef.current=monacoEditor;monacoEditor.onDidChangeModelContent(function(){onChange(getValue());});(_monacoEditor$getMode=monacoEditor.getModel())===null||_monacoEditor$getMode===void 0?void 0:_monacoEditor$getMode.updateOptions({tabSize:2});var highlighter=new Highlighter(// @ts-ignore\nwindow.monaco,codeShift,monacoEditor);highlighter.highLightOnDidChangeModelContent(function(){},function(){},undefined,function(){});};var onFormatClick=function onFormatClick(){var unformatted=editorRef.current.getModel().getValue();var formatted=prettier.format(unformatted,{parser:\"babel\",plugins:[parser],useTabs:false,semi:true,singleQuote:true}).replace(/\\n$/,\"\");editorRef.current.setValue(formatted);};return/*#__PURE__*/_jsxs(\"div\",{className:\"editorWrapper\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"button button-format is-primary is-small\",onClick:onFormatClick,children:\"Prettier\"}),/*#__PURE__*/_jsx(MonacoEditor,{editorDidMount:onEditorDidMount,value:initialValue,language:\"javascript\",theme:\"dark\",options:{wordWrap:\"on\",minimap:{enabled:false},showUnused:false,folding:false,lineNumbersMinChars:3,fontSize:16,scrollBeyondLastLine:false,automaticLayout:true},height:\"100%\"})]});};export default CodeEditor;","map":{"version":3,"names":["MonacoEditor","useRef","prettier","parser","codeShift","Highlighter","CodeEditor","onChange","initialValue","editorRef","onEditorDidMount","getValue","monacoEditor","current","onDidChangeModelContent","getModel","updateOptions","tabSize","highlighter","window","monaco","highLightOnDidChangeModelContent","undefined","onFormatClick","unformatted","formatted","format","plugins","useTabs","semi","singleQuote","replace","setValue","wordWrap","minimap","enabled","showUnused","folding","lineNumbersMinChars","fontSize","scrollBeyondLastLine","automaticLayout"],"sources":["/Users/gleb/Desktop/study/react/ts-prod/ts-codepen/packages/local-client/src/components/CodeEditor/CodeEditor.tsx"],"sourcesContent":["import \"./CodeEditor.css\";\nimport \"./SyntaxHighlighting.css\";\nimport MonacoEditor, { EditorDidMount } from \"@monaco-editor/react\";\nimport { FC, useRef } from \"react\";\nimport prettier from \"prettier\";\nimport parser from \"prettier/parser-babel\";\nimport codeShift from \"jscodeshift\";\nimport Highlighter from \"monaco-jsx-highlighter\";\n\ninterface CodeEditorProps {\n  initialValue: string;\n  onChange(value: string): void;\n}\n\nconst CodeEditor: FC<CodeEditorProps> = ({ onChange, initialValue }) => {\n  const editorRef = useRef<any>();\n\n  const onEditorDidMount: EditorDidMount = (getValue, monacoEditor) => {\n    editorRef.current = monacoEditor;\n\n    monacoEditor.onDidChangeModelContent(() => {\n      onChange(getValue());\n    });\n\n    monacoEditor.getModel()?.updateOptions({ tabSize: 2 });\n\n    const highlighter = new Highlighter(\n      // @ts-ignore\n      window.monaco,\n      codeShift,\n      monacoEditor\n    );\n    highlighter.highLightOnDidChangeModelContent(\n      () => {},\n      () => {},\n      undefined,\n      () => {}\n    );\n  };\n\n  const onFormatClick = () => {\n    const unformatted = editorRef.current.getModel().getValue();\n\n    const formatted = prettier\n      .format(unformatted, {\n        parser: \"babel\",\n        plugins: [parser],\n        useTabs: false,\n        semi: true,\n        singleQuote: true,\n      })\n      .replace(/\\n$/, \"\");\n\n    editorRef.current.setValue(formatted);\n  };\n\n  return (\n    <div className=\"editorWrapper\">\n      <button\n        className=\"button button-format is-primary is-small\"\n        onClick={onFormatClick}\n      >\n        Prettier\n      </button>\n      <MonacoEditor\n        editorDidMount={onEditorDidMount}\n        value={initialValue}\n        language=\"javascript\"\n        theme=\"dark\"\n        options={{\n          wordWrap: \"on\",\n          minimap: { enabled: false },\n          showUnused: false,\n          folding: false,\n          lineNumbersMinChars: 3,\n          fontSize: 16,\n          scrollBeyondLastLine: false,\n          automaticLayout: true,\n        }}\n        height=\"100%\"\n      />\n    </div>\n  );\n};\n\nexport default CodeEditor;\n"],"mappings":"AAAA,MAAO,kBAAkB,CACzB,MAAO,0BAA0B,CACjC,MAAOA,aAAY,KAA0B,sBAAsB,CACnE,OAAaC,MAAM,KAAQ,OAAO,CAClC,MAAOC,SAAQ,KAAM,UAAU,CAC/B,MAAOC,OAAM,KAAM,uBAAuB,CAC1C,MAAOC,UAAS,KAAM,aAAa,CACnC,MAAOC,YAAW,KAAM,wBAAwB,CAAC,wFAOjD,GAAMC,WAA+B,CAAG,QAAlCA,WAA+B,MAAmC,IAA7BC,SAAQ,MAARA,QAAQ,CAAEC,YAAY,MAAZA,YAAY,CAC/D,GAAMC,UAAS,CAAGR,MAAM,EAAO,CAE/B,GAAMS,iBAAgC,CAAG,QAAnCA,iBAAgC,CAAIC,QAAQ,CAAEC,YAAY,CAAK,2BACnEH,SAAS,CAACI,OAAO,CAAGD,YAAY,CAEhCA,YAAY,CAACE,uBAAuB,CAAC,UAAM,CACzCP,QAAQ,CAACI,QAAQ,EAAE,CAAC,CACtB,CAAC,CAAC,CAEF,uBAAAC,YAAY,CAACG,QAAQ,EAAE,gDAAvB,sBAAyBC,aAAa,CAAC,CAAEC,OAAO,CAAE,CAAE,CAAC,CAAC,CAEtD,GAAMC,YAAW,CAAG,GAAIb,YAAW,CACjC;AACAc,MAAM,CAACC,MAAM,CACbhB,SAAS,CACTQ,YAAY,CACb,CACDM,WAAW,CAACG,gCAAgC,CAC1C,UAAM,CAAC,CAAC,CACR,UAAM,CAAC,CAAC,CACRC,SAAS,CACT,UAAM,CAAC,CAAC,CACT,CACH,CAAC,CAED,GAAMC,cAAa,CAAG,QAAhBA,cAAa,EAAS,CAC1B,GAAMC,YAAW,CAAGf,SAAS,CAACI,OAAO,CAACE,QAAQ,EAAE,CAACJ,QAAQ,EAAE,CAE3D,GAAMc,UAAS,CAAGvB,QAAQ,CACvBwB,MAAM,CAACF,WAAW,CAAE,CACnBrB,MAAM,CAAE,OAAO,CACfwB,OAAO,CAAE,CAACxB,MAAM,CAAC,CACjByB,OAAO,CAAE,KAAK,CACdC,IAAI,CAAE,IAAI,CACVC,WAAW,CAAE,IACf,CAAC,CAAC,CACDC,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CAErBtB,SAAS,CAACI,OAAO,CAACmB,QAAQ,CAACP,SAAS,CAAC,CACvC,CAAC,CAED,mBACE,aAAK,SAAS,CAAC,eAAe,wBAC5B,eACE,SAAS,CAAC,0CAA0C,CACpD,OAAO,CAAEF,aAAc,sBAGhB,cACT,KAAC,YAAY,EACX,cAAc,CAAEb,gBAAiB,CACjC,KAAK,CAAEF,YAAa,CACpB,QAAQ,CAAC,YAAY,CACrB,KAAK,CAAC,MAAM,CACZ,OAAO,CAAE,CACPyB,QAAQ,CAAE,IAAI,CACdC,OAAO,CAAE,CAAEC,OAAO,CAAE,KAAM,CAAC,CAC3BC,UAAU,CAAE,KAAK,CACjBC,OAAO,CAAE,KAAK,CACdC,mBAAmB,CAAE,CAAC,CACtBC,QAAQ,CAAE,EAAE,CACZC,oBAAoB,CAAE,KAAK,CAC3BC,eAAe,CAAE,IACnB,CAAE,CACF,MAAM,CAAC,MAAM,EACb,GACE,CAEV,CAAC,CAED,cAAenC,WAAU"},"metadata":{},"sourceType":"module"}