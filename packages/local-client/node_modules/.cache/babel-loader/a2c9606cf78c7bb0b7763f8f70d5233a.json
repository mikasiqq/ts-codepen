{"ast":null,"code":"import{useEffect,useRef}from\"react\";import\"./Preview.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var html=\"\\n  <html>\\n    <head>\\n      <style>html { background-color: white; }</style>\\n    </head>\\n    <body>\\n      <div id=\\\"root\\\"></div>\\n      <script>\\n        const handleError = (error) => {\\n          const root = document.querySelector('#root')\\n          root.innerHTML = '<div style=\\\"color: rgb(215, 56, 88); font-family: \\\"Lato\\\",\\\"Helvetica Neue\\\",Helvetica,Arial,sans-serif;\\\"><h4 style=\\\"margin: 5px 0\\\">Runtime error</h4>' + error + '</div>'\\n          console.error(error);\\n        }\\n\\n        window.addEventListener('error', (event) => {\\n          event.preventDefault()\\n          handleError(event.error)\\n        })\\n\\n        window.addEventListener('message', (event) => {\\n          try {\\n            eval(event.data)\\n          } catch (error) {\\n            handleError(error)\\n          }\\n        }, false)\\n      </script>\\n    </body>\\n  </html>\\n\";var Preview=function Preview(_ref){var code=_ref.code,bundlingStatus=_ref.bundlingStatus;var frame=useRef();useEffect(function(){frame.current.srcdoc=html;setTimeout(function(){frame.current.contentWindow.postMessage(code,\"*\");},50);},[code]);return/*#__PURE__*/_jsxs(\"div\",{className:\"previewWrapper\",children:[/*#__PURE__*/_jsx(\"iframe\",{title:\"Code Preview\",ref:frame,sandbox:\"allow-scripts\",srcDoc:html}),bundlingStatus&&/*#__PURE__*/_jsx(\"div\",{className:\"previewError\",children:bundlingStatus})]});};export default Preview;","map":{"version":3,"names":["useEffect","useRef","html","Preview","code","bundlingStatus","frame","current","srcdoc","setTimeout","contentWindow","postMessage"],"sources":["/Users/gleb/Desktop/study/react/ts-prod/ts-codepen/packages/local-client/src/components/Preview/Preview.tsx"],"sourcesContent":["import { FC, useEffect, useRef } from \"react\";\nimport \"./Preview.css\";\ninterface PreviewProps {\n  code: string;\n  bundlingStatus: string;\n}\n\nconst html = `\n  <html>\n    <head>\n      <style>html { background-color: white; }</style>\n    </head>\n    <body>\n      <div id=\"root\"></div>\n      <script>\n        const handleError = (error) => {\n          const root = document.querySelector('#root')\n          root.innerHTML = '<div style=\"color: rgb(215, 56, 88); font-family: \"Lato\",\"Helvetica Neue\",Helvetica,Arial,sans-serif;\"><h4 style=\"margin: 5px 0\">Runtime error</h4>' + error + '</div>'\n          console.error(error);\n        }\n\n        window.addEventListener('error', (event) => {\n          event.preventDefault()\n          handleError(event.error)\n        })\n\n        window.addEventListener('message', (event) => {\n          try {\n            eval(event.data)\n          } catch (error) {\n            handleError(error)\n          }\n        }, false)\n      </script>\n    </body>\n  </html>\n`;\n\nconst Preview: FC<PreviewProps> = ({ code, bundlingStatus }) => {\n  const frame = useRef<any>();\n\n  useEffect(() => {\n    frame.current.srcdoc = html;\n    setTimeout(() => {\n      frame.current.contentWindow.postMessage(code, \"*\");\n    }, 50);\n  }, [code]);\n\n  return (\n    <div className=\"previewWrapper\">\n      <iframe\n        title=\"Code Preview\"\n        ref={frame}\n        sandbox=\"allow-scripts\"\n        srcDoc={html}\n      />\n      {bundlingStatus && <div className=\"previewError\">{bundlingStatus}</div>}\n    </div>\n  );\n};\n\nexport default Preview;\n"],"mappings":"AAAA,OAAaA,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC7C,MAAO,eAAe,CAAC,wFAMvB,GAAMC,KAAI,i3BA6BT,CAED,GAAMC,QAAyB,CAAG,QAA5BA,QAAyB,MAAiC,IAA3BC,KAAI,MAAJA,IAAI,CAAEC,cAAc,MAAdA,cAAc,CACvD,GAAMC,MAAK,CAAGL,MAAM,EAAO,CAE3BD,SAAS,CAAC,UAAM,CACdM,KAAK,CAACC,OAAO,CAACC,MAAM,CAAGN,IAAI,CAC3BO,UAAU,CAAC,UAAM,CACfH,KAAK,CAACC,OAAO,CAACG,aAAa,CAACC,WAAW,CAACP,IAAI,CAAE,GAAG,CAAC,CACpD,CAAC,CAAE,EAAE,CAAC,CACR,CAAC,CAAE,CAACA,IAAI,CAAC,CAAC,CAEV,mBACE,aAAK,SAAS,CAAC,gBAAgB,wBAC7B,eACE,KAAK,CAAC,cAAc,CACpB,GAAG,CAAEE,KAAM,CACX,OAAO,CAAC,eAAe,CACvB,MAAM,CAAEJ,IAAK,EACb,CACDG,cAAc,eAAI,YAAK,SAAS,CAAC,cAAc,UAAEA,cAAc,EAAO,GACnE,CAEV,CAAC,CAED,cAAeF,QAAO"},"metadata":{},"sourceType":"module"}