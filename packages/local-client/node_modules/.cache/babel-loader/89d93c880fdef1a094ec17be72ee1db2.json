{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gleb/Desktop/study/react/ts-prod/ts-codepen/packages/local-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/gleb/Desktop/study/react/ts-prod/ts-codepen/packages/local-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useEffect}from\"react\";import CodeEditor from\"../CodeEditor/CodeEditor\";import Preview from\"../Preview/Preview\";import Resizable from\"../Resizable/Resizable\";import{useActions}from\"../../hooks/useActions\";import{useTypedSelector}from\"../../hooks/useTypedSelector\";import\"./CodeWrapper.css\";import{useCumulativeCode}from\"../../hooks/useCumulativeCode\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CodeWrapper=function CodeWrapper(_ref){var cell=_ref.cell;var _useActions=useActions(),updateCell=_useActions.updateCell,createBundle=_useActions.createBundle;var bundle=useTypedSelector(function(state){return state.bundles[cell.id];});var cumulativeCode=useCumulativeCode(cell.id);useEffect(function(){if(!bundle){createBundle(cell.id,cumulativeCode);return;}var timer=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:createBundle(cell.id,cumulativeCode);case 1:case\"end\":return _context.stop();}}},_callee);})),1000);return function(){clearTimeout(timer);};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[cumulativeCode,cell.id,createBundle]);return/*#__PURE__*/_jsx(Resizable,{direction:\"vertical\",children:/*#__PURE__*/_jsxs(\"div\",{style:{height:\"calc(100% - 10px)\",display:\"flex\",flexDirection:\"row\"},children:[/*#__PURE__*/_jsx(Resizable,{direction:\"horizontal\",children:/*#__PURE__*/_jsx(CodeEditor,{initialValue:cell.content,onChange:function onChange(value){return updateCell(cell.id,value||\"\");}})}),/*#__PURE__*/_jsx(\"div\",{className:\"progressWrapper\",children:!bundle||bundle.loading?/*#__PURE__*/_jsx(\"div\",{className:\"progressCover\",children:/*#__PURE__*/_jsx(\"progress\",{className:\"progress is-small is-primary\",max:\"100\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430\"})}):/*#__PURE__*/_jsx(Preview,{code:bundle.code,bundlingStatus:bundle.error})})]})});};export default CodeWrapper;","map":{"version":3,"names":["React","useEffect","CodeEditor","Preview","Resizable","useActions","useTypedSelector","useCumulativeCode","CodeWrapper","cell","updateCell","createBundle","bundle","state","bundles","id","cumulativeCode","timer","setTimeout","clearTimeout","height","display","flexDirection","content","value","loading","code","error"],"sources":["/Users/gleb/Desktop/study/react/ts-prod/ts-codepen/packages/local-client/src/components/CodeWrapper/CodeWrapper.tsx"],"sourcesContent":["import React, { FC, useEffect } from \"react\";\nimport CodeEditor from \"../CodeEditor/CodeEditor\";\nimport Preview from \"../Preview/Preview\";\nimport Resizable from \"../Resizable/Resizable\";\nimport { Cell } from \"../../store/cell\";\nimport { useActions } from \"../../hooks/useActions\";\nimport { useTypedSelector } from \"../../hooks/useTypedSelector\";\nimport \"./CodeWrapper.css\";\nimport { useCumulativeCode } from \"../../hooks/useCumulativeCode\";\n\ninterface CodeWrapperProps {\n  cell: Cell;\n}\n\nconst CodeWrapper: FC<CodeWrapperProps> = ({ cell }) => {\n  const { updateCell, createBundle } = useActions();\n  const bundle = useTypedSelector((state) => state.bundles[cell.id]);\n  const cumulativeCode = useCumulativeCode(cell.id);\n\n  useEffect(() => {\n    if (!bundle) {\n      createBundle(cell.id, cumulativeCode);\n      return;\n    }\n    const timer = setTimeout(async () => {\n      createBundle(cell.id, cumulativeCode);\n    }, 1000);\n\n    return () => {\n      clearTimeout(timer);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [cumulativeCode, cell.id, createBundle]);\n\n  return (\n    <Resizable direction=\"vertical\">\n      <div\n        style={{\n          height: \"calc(100% - 10px)\",\n          display: \"flex\",\n          flexDirection: \"row\",\n        }}\n      >\n        <Resizable direction=\"horizontal\">\n          <CodeEditor\n            initialValue={cell.content}\n            onChange={(value) => updateCell(cell.id, value || \"\")}\n          />\n        </Resizable>\n        <div className=\"progressWrapper\">\n          {!bundle || bundle.loading ? (\n            <div className=\"progressCover\">\n              <progress className=\"progress is-small is-primary\" max=\"100\">\n                Загрузка\n              </progress>\n            </div>\n          ) : (\n            <Preview code={bundle.code} bundlingStatus={bundle.error} />\n          )}\n        </div>\n      </div>\n    </Resizable>\n  );\n};\n\nexport default CodeWrapper;\n"],"mappings":"4UAAA,MAAOA,MAAK,EAAQC,SAAS,KAAQ,OAAO,CAC5C,MAAOC,WAAU,KAAM,0BAA0B,CACjD,MAAOC,QAAO,KAAM,oBAAoB,CACxC,MAAOC,UAAS,KAAM,wBAAwB,CAE9C,OAASC,UAAU,KAAQ,wBAAwB,CACnD,OAASC,gBAAgB,KAAQ,8BAA8B,CAC/D,MAAO,mBAAmB,CAC1B,OAASC,iBAAiB,KAAQ,+BAA+B,CAAC,wFAMlE,GAAMC,YAAiC,CAAG,QAApCA,YAAiC,MAAiB,IAAXC,KAAI,MAAJA,IAAI,CAC/C,gBAAqCJ,UAAU,EAAE,CAAzCK,UAAU,aAAVA,UAAU,CAAEC,YAAY,aAAZA,YAAY,CAChC,GAAMC,OAAM,CAAGN,gBAAgB,CAAC,SAACO,KAAK,QAAKA,MAAK,CAACC,OAAO,CAACL,IAAI,CAACM,EAAE,CAAC,GAAC,CAClE,GAAMC,eAAc,CAAGT,iBAAiB,CAACE,IAAI,CAACM,EAAE,CAAC,CAEjDd,SAAS,CAAC,UAAM,CACd,GAAI,CAACW,MAAM,CAAE,CACXD,YAAY,CAACF,IAAI,CAACM,EAAE,CAAEC,cAAc,CAAC,CACrC,OACF,CACA,GAAMC,MAAK,CAAGC,UAAU,wEAAC,qIACvBP,YAAY,CAACF,IAAI,CAACM,EAAE,CAAEC,cAAc,CAAC,CAAC,sDACvC,GAAE,IAAI,CAAC,CAER,MAAO,WAAM,CACXG,YAAY,CAACF,KAAK,CAAC,CACrB,CAAC,CACD;AACF,CAAC,CAAE,CAACD,cAAc,CAAEP,IAAI,CAACM,EAAE,CAAEJ,YAAY,CAAC,CAAC,CAE3C,mBACE,KAAC,SAAS,EAAC,SAAS,CAAC,UAAU,uBAC7B,aACE,KAAK,CAAE,CACLS,MAAM,CAAE,mBAAmB,CAC3BC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,KACjB,CAAE,wBAEF,KAAC,SAAS,EAAC,SAAS,CAAC,YAAY,uBAC/B,KAAC,UAAU,EACT,YAAY,CAAEb,IAAI,CAACc,OAAQ,CAC3B,QAAQ,CAAE,kBAACC,KAAK,QAAKd,WAAU,CAACD,IAAI,CAACM,EAAE,CAAES,KAAK,EAAI,EAAE,CAAC,EAAC,EACtD,EACQ,cACZ,YAAK,SAAS,CAAC,iBAAiB,UAC7B,CAACZ,MAAM,EAAIA,MAAM,CAACa,OAAO,cACxB,YAAK,SAAS,CAAC,eAAe,uBAC5B,iBAAU,SAAS,CAAC,8BAA8B,CAAC,GAAG,CAAC,KAAK,8DAEjD,EACP,cAEN,KAAC,OAAO,EAAC,IAAI,CAAEb,MAAM,CAACc,IAAK,CAAC,cAAc,CAAEd,MAAM,CAACe,KAAM,EAC1D,EACG,GACF,EACI,CAEhB,CAAC,CAED,cAAenB,YAAW"},"metadata":{},"sourceType":"module"}